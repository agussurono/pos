<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            background-color: #f8f9fa;
            overflow: hidden;
        }

        #fullscreenButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            font-size: 20px;
            padding: 20px 40px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        #app-frame {
            width: 100%;
            height: 100%;
            border: none;
            display: none; /* Sembunyi sampai fullscreen diklik */
        }

        .desktop-blocked {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            padding: 20px;
            color: #721c24;
            background-color: #f8d7da;
        }
    </style>
</head>
<body>

    <button id="fullscreenButton" class="btn btn-danger btn-lg" onclick="openFullscreen()">
        KLIK UNTUK FULL SCREEN
    </button>

    <iframe id="app-frame" src="" allow="geolocation; microphone; camera"></iframe>

    <script>
        // 1. Ambil Parameter ID dari URL browser
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('id') || "default"; // Jika tidak ada id, isi default

        // 2. Gabungkan ke URL GAS
        const baseGasUrl = "https://script.google.com/macros/s/AKfycbxNJzLMzaAMjsyxt7Fx_LwyIKKGi8-7fHSP2cExlIB893wRPc71WQPmbnUQCTB-0F6F/exec";
        const finalUrl = baseGasUrl + "?id=" + userId;

        function checkDevice() {
            const UA = navigator.userAgent;
            const width = window.innerWidth;
            
            // Deteksi Desktop (Jika bukan mobile regex DAN lebar layar besar)
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(UA);
            const isSmallScreen = width < 1024;

            // JIKA TERDETEKSI PC/DESKTOP (Bukan Mobile & Layar Lebar)
            if (!isMobile && !isSmallScreen) {
                document.body.innerHTML = `
                    <div class="desktop-blocked">
                        <div>
                            <h1 class="display-4">Akses Ditolak</h1>
                            <p class="lead">Aplikasi ini hanya untuk perangkat Mobile (HP/Tablet)</p>
                        </div>
                    </div>`;
                return false; 
            }
            return true;
        }

        function openFullscreen() {
            // Jalankan cek perangkat lagi sebelum lanjut
            if (!checkDevice()) return;

            var elem = document.documentElement;
            var frame = document.getElementById('app-frame');
            var btn = document.getElementById('fullscreenButton');

            // Set URL ke Iframe saat tombol diklik
            frame.src = finalUrl;
            frame.style.display = "block";

            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.webkitRequestFullscreen) {
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) {
                elem.msRequestFullscreen();
            }
        }

        function fullscreenChange() {
            const isFullscreen = document.fullscreenElement || 
                                 document.webkitFullscreenElement || 
                                 document.msFullscreenElement;

            const btn = document.getElementById('fullscreenButton');
            if (isFullscreen) {
                btn.style.display = 'none';
            } else {
                btn.style.display = 'block';
            }
        }

        // Event Listeners
        document.addEventListener('fullscreenchange', fullscreenChange);
        document.addEventListener('webkitfullscreenchange', fullscreenChange);
        document.addEventListener('MSFullscreenChange', fullscreenChange);

        // Jalankan proteksi saat halaman pertama dimuat
        window.onload = function() {
            checkDevice();
        };
    </script>
</body>
</html>


